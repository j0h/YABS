<div class="container-course container-fluid">
    <div class="background-course">
    <span style="color: #DDD; font-size:9px; position:absolute; opacity:0.8; right: 0;">Bild &copy; Peter Winandy</span>
        <div class="container">
            <h1 data-fittext="1.2" data-fittext-min="8" data-fittext-max="50">{{room.name}}</h1>
            <div ng-switch on="showAdmin">
                <div ng-switch-when="false"><div ng-include="'course_student.html'"></div></div>
                <div ng-switch-when="true"><div ng-include="'course_admin.html'"></div></div>
            </div>            
            <div class="container row shadowed">
                <h2>Optionen</h2>
                Im folgenden findest Du einige Optionen, die dir helfen, schneller auf Fragen zuzugreifen. Sortiere alle Fragen oder wende einen Volltextfilter auf jegliche Inhalte an. Die Filter werden automatisch auf neue Inhalte angewandt.
                <br><br>
                <div class="form-group">
                    <label for="qSort" class="col-sm-2 control-label">Sortierung</label> 
                    <div class="col-sm-10">
                        <select id="qSort" class="form-control" ng-model="orderProp">
                            <option value="-votes">Fragen mit den meisten Unterstützern</option>
                            <option value="elapsedSince">Neueste Fragen</option>
                            <option value="-elapsedSince">Älteste Fragen</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="qSearch" class="col-sm-2 control-label">Volltextfilter</label> 
                    <div class=" col-sm-10">
                        <input id="qSearch" class="form-control col-sm-10" type="search" ng-model="query" placeholder="Suche...">
                    </div>
                </div>
            </div>
            <div ng-repeat="question in room.questions | filter:query | orderBy:orderProp">
                <div ng-if="question.visible">
                <h2>Frage</h2>
                <div class="row question">
                    <div class="col-md-3 col-sm-3 col-lg-2 col-xs-12">
                        <div class="row text-center shadowed userinfo">
                            <div class="hidden-xs col-sm-12 vcenter"><img class="img-circle avatar" ng-src="{{question.author.avatar}}" /></div><!--
                         --><div class="col-xs-5 col-sm-12 vcenter"><span class="username">{{question.author.name}}</span><span class="time">vor {{question.elapsedSince < 60 ? question.elapsedSince + ' Minuten' : (Math.floor(question.elapsedSince/60) < 24 ? Math.floor(question.elapsedSince/60) + ' Stunden' : Math.floor(question.elapsedSince/60/24) + ' Tagen')}}</span></div><!--
                         --><div class="col-xs-7 col-sm-12 votebutton vcenter">
                                <button type="button" ng-click="voteQuestion(question)" class="btn btn-default" ng-disabled="question.hasVote" >
                                    <span class="glyphicon glyphicon-chevron-up" aria-hidden="true"></span> Frage unterstützen
                                </button>
                                <span>{{question.votes}} Studenten haben die selbe Frage</span>
                                <button type="button" style="margin:5px" ng-if="showAdmin" ng-click="deleteQuestion(question)" class="btn btn-danger btn-sm">
                                    <span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span> Frage löschen
                                </button>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-9 col-md-9 col-lg-10 col-xs-12 textpadding">
                        {{question.content}}
                    </div>
                    <div ng-repeat="image in question.images" class="col-sm-9 col-md-9 col-lg-10 col-xs-12 textpadding">
                        <a href="{{image.path}}" target="_blank"><img src="{{image.path}}" class="col-sm-3 img-thumbnail" /></a>
                    </div>
                </div>
                <div class="panel panel-default">
                    <a class="collapsed" data-toggle="collapse" data-target="#{{question._id}}">
                        <div class="panel-heading">
                            <h4>Antworten</h4>
                        </div>
                    </a>
                    <div class="out collapse" id="{{question._id}}">
                        
                        <div class="row question answer" ng-class="answer.isAnswer ? 'answer-correct' : ''" ng-repeat="answer in question.answers">
                            <div class="col-md-3 col-sm-3 col-lg-2 col-xs-12">
                                <div class="row text-center shadowed userinfo">
                                    <div class="hidden-xs col-sm-12 vcenter"><img class="img-circle avatar" ng-src="{{answer.author.avatar}}" /></div><!--
                                 --><div class="col-xs-5 col-sm-12 vcenter"><span class="username">{{answer.author.name}}</span><span class="time">vor {{answer.elapsedSince <= 60 ? answer.elapsedSince + ' Minuten' : (Math.floor(answer.elapsedSince/60) < 24 ? Math.floor(answer.elapsedSince/60) + ' Stunden' : Math.floor(answer.elapsedSince/60/24) + ' Tagen')}} </span></div><!--
                                 --><div ng-if="showAdmin || answer.isAnswer" class="col-xs-7 col-sm-12 votebutton vcenter">
                                        <!-- refactor -->
                                        <button ng-disabled="answer.isAnswer || answer.deleted" ng-click="markAsAnswer(question, answer)" type="button" class="btn btn-success btn-sm">
                                            <span class="glyphicon glyphicon-ok" aria-hidden="true"></span> {{answer.isAnswer ? 'Richtige Antwort' : 'Als Antwort markieren'}}
                                        </button>
                                        <button type="button" ng-disabled="answer.deleted" style="margin:5px" ng-if="showAdmin" ng-click="deleteAnswer(question, answer)" class="btn btn-danger btn-sm">
                                            <span class="glyphicon glyphicon-remove-sign" aria-hidden="true"></span> Inhalt löschen
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-9 col-md-9 col-lg-10 col-xs-12 textpadding">
                                {{answer.content}}
                            </div>
                            <div ng-repeat="image in answer.images" class="row col-sm-9 col-md-9 col-lg-10 col-xs-12 textpadding">
                                <a href="{{image.path}}" target="_blank"><img src="{{image.path}}" class="col-sm-3 img-thumbnail" /></a>
                            </div>
                        </div>

                        <div class="row question answer shadowed">
                            <div class="col-md-12">
                                <h3>Deine Antwort</h3>
                            </div>
                            <div class="col-md-12 textpadding">
                                <form role="form" class="ng-pristine ng-valid">
                                    <div class="form-group">
                                        <div class="btn-group" role="group" aria-label="...">
                                          <button ng-click="uploadImage($event, question._id)" type="button" class="btn btn-default"><input type="file" accept="image/*" style="display:none"><span class="glyphicon glyphicon-picture" aria-hidden="true"></span></button>
                                          <!--<button type="button" class="btn btn-default">LaTeX</button>-->
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <textarea class="form-control" ng-model="answerText[question._id]" style="max-width:100%" rows="5" placeholder="Deine Antwort auf {{question.author.name}}s Frage..."></textarea>
                                    </div>
                                    <span ng-if="imageUploads[question._id]">Angehängte Bilder: {{imageUploads[question._id].length}}</span>
                                    <span ng-if="uploading[question._id]">Bild wird hochgeladen <img src="loading.gif" style="height: 18px; width: 18px;" /></span>
                                    <button ng-disabled="uploading[question._id]" type="submit" class="btn btn-primary pull-right" ng-click="addAnswer(question)"><span class="glyphicon glyphicon-send" aria-hidden="true"></span> Absenden</button>
                                </form>
                                <div class="clearfix"></div>
                            </div>
                        </div>
                    <div>
                    <hr>
                </div>

            </div>
        </div>
        </div>
    </div>
</div>